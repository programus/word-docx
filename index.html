<!DOCTYPE html>
<head>
  <title>Word Docx</title>
  <meta charset="utf-8">
  <script src="./dist/word-docx.dev.js"></script>
</head>
<body>

<div>
  file to unzip: <input type="file" id="file" name="file" />
</div>
<word-docx data-file="#file" var-name="docx" enable-css="true"></word-docx>
<div>something below</div>
<script>
  document.onselectionchange = (evt) => {
    console.log('sel changed')
  }
  document.querySelector('word-docx').addEventListener('file-loaded', (evt) => {
    const doc = evt.detail.wordDoc
    doc.setCssClass('masking', {
      color: {
        'val': 'ff00ff',
      },
      shd: {
        'fill': '0000ff',
      },
      i: {
        'val': 'true',
      },
    })

    // doc.overrideFormat({
    //   from: {
    //     node: {
    //       info: {
    //         paraId: '4D5680C1',
    //         countTag: 't',
    //         tTagIndex: 1,
    //       },
    //     },
    //     textOffset: 2,
    //   },
    //   to: {
    //     node: {
    //       info: {
    //         paraId: '6A440BCB',
    //         countTag: 't',
    //         tTagIndex: 3,
    //       }
    //     },
    //     textOffset: 0,
    //   },
    //   format: {
    //     cssClasses: [
    //       'masking',
    //     ],
    //   },
    // })

    doc.overrideFormat({
      from: {
        node: {
          info: {
            paraId: '4D5680C1',
            tTagIndex: 1,
          },
        },
        textOffset: 2,
      },
      to: {
        node: {
          info: {
            paraId: '4D5680C1',
            tTagIndex: 1,
          }
        },
        textOffset: 4,
      },
      format: {
        cssClasses: [
          'masking',
        ],
      },
    })

  })
</script>
</body>